{% comment %} Packs — Cartes descriptives {% endcomment %}
<section id="pv-{{ section.id }}" class="pv"
  style="--pv-bg: {{ section.settings.bg }}; --pv-fg: {{ section.settings.fg }}; --pv-accent: {{ section.settings.accent }}; --pv-border: {{ section.settings.border }}; --pv-glow: {{ section.settings.glow }}; --pv-radius: {{ section.settings.radius }}px; --pv-gap: {{ section.settings.gap }}px; --pv-cols: {{ section.settings.columns }};"
  aria-label="Packs descriptifs">
  <div class="pv-wrap">
    {% if section.settings.title != blank %}
      <header class="pv-head">
        <h2 class="pv-title">{{ section.settings.title }}</h2>
        {% if section.settings.subtitle != blank %}<p class="pv-sub">{{ section.settings.subtitle }}</p>{% endif %}
      </header>
    {% endif %}

    <div class="pv-grid">
      {% for block in section.blocks %}
        {% if block.type == 'bundle' %}
          <article class="pv-card {% if block.settings.highlight %}is-popular{% endif %}" {{ block.shopify_attributes }}>
            {% if block.settings.ribbon != blank %}
              <div class="pv-ribbon">
                <svg viewBox="0 0 24 24" width="14" height="14" aria-hidden="true"><path fill="currentColor" d="M12 2l2.9 6 6.6.5-5 4.3 1.5 6.3L12 16.8 6 19.1l1.5-6.3-5-4.3 6.6-.5z"/></svg>
                {{ block.settings.ribbon }}
              </div>
            {% endif %}

            <div class="pv-media">
              {% if block.settings.image != blank %}
                {{ block.settings.image | image_url: width: 1200 | image_tag: alt: block.settings.title, loading: 'lazy' }}
              {% else %}<div class="pv-ph"></div>{% endif %}
            </div>

            <div class="pv-content">
              <div class="pv-top">
                <h3 class="pv-name">{{ block.settings.title }}</h3>
                {% if block.settings.price_value != blank %}
                  <div class="pv-price">
                    <span class="pv-price-label">{{ block.settings.price_text }}</span>
                    <span class="pv-price-value">{{ block.settings.price_value }}</span>
                  </div>
                {% endif %}
              </div>

              {% if block.settings.description != blank %}
                <div class="pv-desc rte">{{ block.settings.description }}</div>
              {% endif %}

              {% assign items = block.settings.items | split: '\n' %}
              {% if items.size > 0 %}
                <ul class="pv-list">
                  {% for it in items %}
                    {% assign line = it | strip %}
                    {% if line != '' %}
                      <li class="pv-li"><svg viewBox="0 0 24 24" width="16" height="16" class="pv-ico" aria-hidden="true"><path fill="currentColor" d="M9.5 16.2l-3.7-3.7 1.4-1.4 2.3 2.3 5.3-5.3 1.4 1.4z"/></svg><span>{{ line }}</span></li>
                    {% endif %}
                  {% endfor %}
                </ul>
              {% endif %}

              <div class="pv-badges">
                {% if block.settings.badge_cod %}<span class="pv-badge">Paiement à la livraison</span>{% endif %}
                {% if block.settings.badge_delivery %}<span class="pv-badge">Livraison nationale</span>{% endif %}
                {% if block.settings.badge_return %}<span class="pv-badge">Retour 7 jours</span>{% endif %}
              </div>

              {% if block.settings.btn_label != blank %}
                <div class="pv-cta"><a class="pv-btn" href="{{ block.settings.link | default: '#' }}" aria-label="Voir {{ block.settings.title }}">{{ block.settings.btn_label }}</a></div>
              {% endif %}
            </div>
          </article>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  <style>
    .pv{background: var(--pv-bg,#ffffff); color: var(--pv-fg,#1f2937); padding:28px 0}
    .pv-wrap{max-width:1200px; margin:0 auto; padding:0 16px}
    .pv-head{margin-bottom:16px; text-align:center}
    .pv-title{margin:0; font-size:clamp(20px,2.6vw,30px); font-weight:800}
    .pv-sub{margin:6px 0 0; color:#6b7280; font-size:14px}
    .pv-grid{display:grid; gap: var(--pv-gap,16px); grid-template-columns: repeat(var(--pv-cols,1), minmax(0,1fr))}
    @media (min-width: 900px){ .pv-card{ grid-template-columns: 44% 56% } }
    .pv-card{position:relative; display:grid; grid-template-columns: 1fr; gap:12px; background:#fff; border-radius: var(--pv-radius,14px); box-shadow: 0 0 0 1px var(--pv-border,#e5e7eb); isolation:isolate; overflow:hidden}
    .pv-card::before{content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none; box-shadow: 0 0 22px var(--pv-glow,#6EC1FF) inset; opacity:.28}
    .pv-card.is-popular::before{opacity:.40}
    .pv-ribbon{position:absolute; top:10px; right:10px; z-index:2; display:inline-flex; gap:6px; align-items:center; background: rgba(26,74,138,.08); color: var(--pv-accent,#1a4a8a); padding:6px 10px; border-radius:999px; font-size:12px; font-weight:800}
    .pv-media{position:relative; min-height:220px; background:#f5f7fb}
    .pv-media img{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    .pv-ph{width:100%; height:100%; background:linear-gradient(135deg,#eef2f7,#e5ecfb)}
    .pv-content{padding:14px}
    .pv-top{display:flex; align-items:flex-end; justify-content:space-between; gap:10px}
    .pv-name{margin:0; font-size:18px; font-weight:800}
    .pv-price{display:flex; gap:8px; align-items:flex-end}
    .pv-price-label{font-size:12px; color:#6b7280}
    .pv-price-value{font-size:20px; font-weight:800; color:#111827}
    .pv-desc{margin:8px 0 10px}
    .pv-list{list-style:none; margin:0; padding:0; display:grid; gap:6px}
    .pv-li{display:flex; gap:8px; align-items:flex-start; color:#374151; font-size:14px}
    .pv-ico{color: var(--pv-accent,#1a4a8a); flex-shrink:0; margin-top:2px}
    .pv-badges{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px}
    .pv-badge{background:#ecf2ff; color:#1a4a8a; border-radius:999px; padding:4px 10px; font-size:12px; font-weight:700}
    .pv-cta{margin-top:12px}
    .pv-btn{display:inline-block; width:100%; text-align:center; padding:10px 14px; border-radius:999px; text-decoration:none; font-weight:800; background: var(--pv-accent,#1a4a8a); color:#fff; box-shadow: 0 0 0 2px rgba(255,255,255,.15) inset, 0 6px 14px rgba(26,74,138,.25)}
    .pv-btn:hover{filter:brightness(1.07)}
  </style>

  {% schema %}
  {
    "name": "Packs — Cartes descriptives",
    "settings": [
      { "type": "text", "id": "title", "label": "Titre", "default": "Nos packs du moment" },
      { "type": "text", "id": "subtitle", "label": "Sous-titre", "default": "Descriptions claires + listes d’articles" },
      { "type": "color", "id": "bg", "label": "Fond de la section", "default": "#ffffff" },
      { "type": "color", "id": "fg", "label": "Texte", "default": "#1f2937" },
      { "type": "color", "id": "accent", "label": "Couleur d’accent", "default": "#1a4a8a" },
      { "type": "color", "id": "border", "label": "Bordure des cartes", "default": "#e5e7eb" },
      { "type": "color", "id": "glow", "label": "Couleur du glow (bordure)", "default": "#6EC1FF" },
      { "type": "select", "id": "columns", "label": "Colonnes (desktop)", "default": "1", "options": [ { "value": "1", "label": "1" }, { "value": "2", "label": "2" } ] },
      { "type": "number", "id": "gap", "label": "Espace entre cartes (px)", "default": 16 },
      { "type": "number", "id": "radius", "label": "Arrondi des coins (px)", "default": 14 }
    ],
    "blocks": [
      { "type": "bundle", "name": "Pack",
        "settings": [
          { "type": "image_picker", "id": "image", "label": "Image du pack" },
          { "type": "text", "id": "title", "label": "Titre du pack", "default": "Pack 5 pièces – 385 000 DA" },
          { "type": "text", "id": "price_text", "label": "Libellé prix", "default": "Prix" },
          { "type": "text", "id": "price_value", "label": "Valeur du prix (texte)", "default": "385 000 DA" },
          { "type": "text", "id": "ribbon", "label": "Badge (coin)", "default": "Offre spéciale" },
          { "type": "checkbox", "id": "highlight", "label": "Mettre en avant (glow + badge)", "default": true },
          { "type": "richtext", "id": "description", "label": "Description", "default": "<p>Un pack malin pour la maison et le jardin.</p>" },
          { "type": "textarea", "id": "items", "label": "Liste des articles (1 par ligne)", "default": "Article 1\nArticle 2\nArticle 3" },
          { "type": "text", "id": "btn_label", "label": "Texte du bouton", "default": "Voir le pack" },
          { "type": "url", "id": "link", "label": "Lien (page produit/collection)" },
          { "type": "checkbox", "id": "badge_cod", "label": "Afficher “Paiement à la livraison”", "default": true },
          { "type": "checkbox", "id": "badge_delivery", "label": "Afficher “Livraison nationale”", "default": true },
          { "type": "checkbox", "id": "badge_return", "label": "Afficher “Retour 7 jours”", "default": true }
        ]
      }
    ],
    "max_blocks": 6,
    "presets": [{ "name": "Packs — Cartes descriptives", "blocks": [ { "type": "bundle" }, { "type": "bundle" }, { "type": "bundle" } ] }]
  }
  {% endschema %}
</section>
