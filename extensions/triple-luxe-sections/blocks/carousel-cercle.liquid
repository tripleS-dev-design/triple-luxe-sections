{{ 'carousel-cercle.css' | asset_url | stylesheet_tag }}

<section class="circle-marquee"
  style="
    --cm-size: {{ section.settings.size | default: 140 }}px;
    --cm-gap: {{ section.settings.gap | default: 16 }}px;
    --cm-speed: {{ section.settings.speed | default: 30 }}s;
    --cm-border: {{ section.settings.border_width | default: 2 }}px;
    --cm-border-color: {{ section.settings.border_color | default: '#ffd1e6' }};
  ">
  {% if section.settings.heading != blank %}
    <h2 class="cm-title">{{ section.settings.heading }}</h2>
  {% endif %}

  <div class="cm-viewport">
    <div class="cm-track">
      {% for i in (1..6) %}
        {% capture k_img %}image_{{ i }}{% endcapture %}
        {% capture k_alt %}alt_{{ i }}{% endcapture %}
        {% capture k_link %}link_{{ i }}{% endcapture %}
        {% assign img = section.settings[k_img] %}
        {% assign alt = section.settings[k_alt] | default: 'Image ' | append: i %}
        {% assign lnk = section.settings[k_link] %}
        {% if img != blank %}
          <a {% if lnk != blank %}href="{{ lnk }}"{% endif %} class="cm-item" aria-label="{{ alt | escape }}">
            {{ img
              | image_url: width: 800
              | image_tag:
                class: 'cm-img',
                alt: alt,
                loading: 'lazy',
                widths: '160,240,320,480,640,800',
                sizes: '(max-width: 600px) 160px, 240px'
            }}
          </a>
        {% endif %}
      {% endfor %}

      {%- comment -%} duplicate for infinite marquee {%- endcomment -%}
      {% for i in (1..6) %}
        {% capture k_img %}image_{{ i }}{% endcapture %}
        {% capture k_alt %}alt_{{ i }}{% endcapture %}
        {% capture k_link %}link_{{ i }}{% endcapture %}
        {% assign img = section.settings[k_img] %}
        {% assign alt = section.settings[k_alt] | default: 'Image ' | append: i %}
        {% assign lnk = section.settings[k_link] %}
        {% if img != blank %}
          <a {% if lnk != blank %}href="{{ lnk }}"{% endif %} class="cm-item" aria-label="{{ alt | escape }}">
            {{ img
              | image_url: width: 800
              | image_tag:
                class: 'cm-img',
                alt: alt,
                loading: 'lazy',
                widths: '160,240,320,480,640,800',
                sizes: '(max-width: 600px) 160px, 240px'
            }}
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Carousel Circle",
  "target": "section",
  "settings": [
    { "type": "text",  "id": "heading", "label": "Title", "default": "Our collection" },
    { "type": "range", "id": "size", "label": "Circle diameter (px)", "min": 60, "max": 220, "step": 2, "default": 140 },
    { "type": "range", "id": "gap", "label": "Gap (px)", "min": 6, "max": 40, "step": 1, "default": 16 },
    { "type": "range", "id": "speed", "label": "Scroll speed (s)", "min": 8, "max": 60, "step": 1, "default": 30 },
    { "type": "color", "id": "border_color", "label": "Border color", "default": "#ffd1e6" },
    { "type": "range", "id": "border_width", "label": "Border width (px)", "min": 0, "max": 6, "step": 1, "default": 2 },

    { "type": "image_picker", "id": "image_1", "label": "Image 1" },
    { "type": "text", "id": "alt_1", "label": "Alt 1", "default": "Image 1" },
    { "type": "url",  "id": "link_1", "label": "Link 1" },

    { "type": "image_picker", "id": "image_2", "label": "Image 2" },
    { "type": "text", "id": "alt_2", "label": "Alt 2", "default": "Image 2" },
    { "type": "url",  "id": "link_2", "label": "Link 2" },

    { "type": "image_picker", "id": "image_3", "label": "Image 3" },
    { "type": "text", "id": "alt_3", "label": "Alt 3", "default": "Image 3" },
    { "type": "url",  "id": "link_3", "label": "Link 3" },

    { "type": "image_picker", "id": "image_4", "label": "Image 4" },
    { "type": "text", "id": "alt_4", "label": "Alt 4", "default": "Image 4" },
    { "type": "url",  "id": "link_4", "label": "Link 4" },

    { "type": "image_picker", "id": "image_5", "label": "Image 5" },
    { "type": "text", "id": "alt_5", "label": "Alt 5", "default": "Image 5" },
    { "type": "url",  "id": "link_5", "label": "Link 5" },

    { "type": "image_picker", "id": "image_6", "label": "Image 6" },
    { "type": "text", "id": "alt_6", "label": "Alt 6", "default": "Image 6" },
    { "type": "url",  "id": "link_6", "label": "Link 6" }
  ]
}
{% endschema %}
