<section class="pg-glow" style="--cols: {{ block.settings.columns }}; --gap: {{ block.settings.gap }}px;">
  {% if block.settings.title != blank %}
    <h3 class="pg-glow__title">{{ block.settings.title | escape }}</h3>
  {% endif %}

  {% assign coll = block.settings.collection %}
  {% assign l = block.settings.limit | default: 8 | plus: 0 %}

  <div class="pg-glow__grid">
    {% if coll != blank %}
      {% for p in coll.products limit: l %}
        <article class="pg-glow__card">
          <a class="pg-glow__img" href="{{ p.url }}">
            {% if p.featured_image %}
              {% assign src = p.featured_image | image_url: width: 900 %}
              <img src="{{ src }}" alt="{{ p.title | escape }}" loading="lazy" class="pg-glow__img-el">
            {% endif %}
          </a>
          <div class="pg-glow__meta">
            <a class="pg-glow__name" href="{{ p.url }}">{{ p.title }}</a>
            {% if block.settings.show_price %}
              <div class="pg-glow__price">
                {{ p.price | default: p.price_min | money }}
              </div>
            {% endif %}
            {% if block.settings.show_cta %}
              <a class="pg-glow__btn" href="{{ p.url }}">{{ block.settings.cta_label | default: 'Voir' }}</a>
            {% endif %}
          </div>
        </article>
      {% endfor %}
    {% else %}
      <div class="pg-glow__empty">Sélectionnez une collection.</div>
    {% endif %}
  </div>
</section>

<style>
.pg-glow{padding:10px 0}
.pg-glow__title{margin:0 0 10px;font-weight:800}
.pg-glow__grid{display:grid;grid-template-columns:repeat(var(--cols,4),minmax(0,1fr));gap:var(--gap,16px)}
.pg-glow__card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;overflow:hidden;transition:transform .2s, box-shadow .2s}
.pg-glow__card:hover{transform:translateY(-2px);box-shadow:0 10px 26px rgba(99,102,241,.18), 0 2px 8px rgba(0,0,0,.06)}
.pg-glow__img{display:block;aspect-ratio:4/5;background:#f7f7f7}
.pg-glow__img-el{width:100%;height:100%;object-fit:cover;display:block}
.pg-glow__meta{padding:10px}
.pg-glow__name{display:block;font-weight:700;line-height:1.25;text-decoration:none;color:inherit;margin-bottom:6px}
.pg-glow__name:hover{text-decoration:underline}
.pg-glow__price{font-weight:800}
.pg-glow__btn{display:inline-block;margin-top:8px;border:1px solid #e5e7eb;border-radius:10px;padding:6px 10px;text-decoration:none;color:inherit}
.pg-glow__btn:hover{background:#f5f5f5}
.pg-glow__empty{opacity:.7}
@media (max-width: 990px){ .pg-glow__grid{grid-template-columns:repeat(3,1fr)} }
@media (max-width: 640px){ .pg-glow__grid{grid-template-columns:repeat(2,1fr)} }
</style>

{% schema %}
{
  "name": "Products Grid Glow",
  "target": "section",
  "settings": [
    { "type": "text", "id": "title", "label": "Titre", "default": "Notre sélection" },
    { "type": "collection", "id": "collection", "label": "Collection" },
    { "type": "range", "id": "limit", "label": "Nombre d'articles", "min": 2, "max": 12, "step": 1, "default": 8 },
    { "type": "range", "id": "columns", "label": "Colonnes", "min": 2, "max": 5, "step": 1, "default": 4 },
    { "type": "range", "id": "gap", "label": "Espace (px)", "min": 6, "max": 28, "step": 1, "default": 16 },
    { "type": "checkbox", "id": "show_price", "label": "Afficher le prix", "default": true },
    { "type": "checkbox", "id": "show_cta", "label": "Afficher le bouton", "default": true },
    { "type": "text", "id": "cta_label", "label": "Label du bouton", "default": "Voir" }
  ]
}
{% endschema %}
