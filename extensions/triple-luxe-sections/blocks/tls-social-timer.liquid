<section class="smt"
  style="
    --smt-bg: {{ block.settings.bg }};
    --smt-fg: {{ block.settings.fg }};
    --smt-accent: {{ block.settings.accent }};
    --smt-icon: {{ block.settings.icon_size }}px;
    --smt-timer: {{ block.settings.timer_size }}px;">
  <div class="smt__wrap page-width">
    {% if block.settings.title != blank %}<h2 class="smt__title">{{ block.settings.title }}</h2>{% endif %}
    {% if block.settings.desc != blank %}<p class="smt__desc">{{ block.settings.desc }}</p>{% endif %}

    {% assign ig = block.settings.instagram_url | default: '' %}
    {% if ig contains 'example.com' %}{% assign ig = '' %}{% endif %}
    {% assign fb = block.settings.facebook_url  | default: '' %}
    {% if fb contains 'example.com' %}{% assign fb = '' %}{% endif %}
    {% assign tt = block.settings.tiktok_url    | default: '' %}
    {% if tt contains 'example.com' %}{% assign tt = '' %}{% endif %}

    {% assign wa_raw = block.settings.whatsapp_phone | default: '' %}
    {% assign wa_clean = wa_raw | replace: ' ', '' | replace: '+', '' | replace: '-', '' | replace: '.', '' | replace: '(', '' | replace: ')' %}
    {% if wa_clean != '' %}{% assign wa = 'https://wa.me/' | append: wa_clean %}{% endif %}

    <div class="smt__icons" aria-label="R√©seaux sociaux">
      {% if ig != blank %}<a class="smt__btn smt__btn--ig" href="{{ ig }}" target="_blank" rel="noopener noreferrer" aria-label="Instagram" title="Instagram">
        <svg viewBox="0 0 24 24" width="100%" height="100%" role="img" aria-hidden="true"><path fill="currentColor" d="M7 2C4.24 2 2 4.24 2 7v10c0 2.76 2.24 5 5 5h10c2.76 0 5-2.24 5-5V7c0-2.76-2.24-5-5-5H7Zm10 2c1.66 0 3 1.34 3 3v10c0 1.66-1.34 3-3 3H7c-1.66 0-3-1.34-3-3V7c0-1.66 1.34-3 3-3h10Zm-5 3.5a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11Zm0 2a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7ZM18 6.25a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5Z"/></svg>
      </a>{% endif %}
      {% if fb != blank %}<a class="smt__btn smt__btn--fb" href="{{ fb }}" target="_blank" rel="noopener noreferrer" aria-label="Facebook" title="Facebook">
        <svg viewBox="0 0 24 24" width="100%" height="100%" role="img" aria-hidden="true"><path fill="currentColor" d="M22 12.06C22 6.48 17.52 2 11.94 2 6.36 2 1.88 6.48 1.88 12.06c0 5 3.66 9.14 8.44 9.94v-7.03H7.9V12.1h2.42V9.86c0-2.39 1.42-3.72 3.6-3.72 1.04 0 2.13.19 2.13.19v2.34h-1.2c-1.18 0-1.55.73-1.55 1.49v1.94h2.64l-.42 2.86h-2.22v7.03c4.78-.8 8.44-4.94 8.44-9.94Z"/></svg>
      </a>{% endif %}
      {% if tt != blank %}<a class="smt__btn smt__btn--tt" href="{{ tt }}" target="_blank" rel="noopener noreferrer" aria-label="TikTok" title="TikTok">
        <svg viewBox="0 0 24 24" width="100%" height="100%" role="img" aria-hidden="true"><path fill="currentColor" d="M16.7 3.2c.73 1.2 1.9 2.26 3.3 2.7.34.1.7.17 1.05.2v3.1a7.7 7.7 0 0 1-4.35-1.43v6.77c0 3.63-2.94 6.56-6.56 6.56a6.57 6.57 0 0 1-2.48-12.67v3.43a3.2 3.2 0 0 0 1.65 6 3.2 3.2 0 0 0 3.2-3.2V2.5h3.2v.7Z"/></svg>
      </a>{% endif %}
      {% if wa != blank %}<a class="smt__btn smt__btn--wa" href="{{ wa }}" target="_blank" rel="noopener noreferrer" aria-label="WhatsApp" title="WhatsApp">
        <svg viewBox="0 0 24 24" width="100%" height="100%" role="img" aria-hidden="true"><path fill="currentColor" d="M20.52 3.48A11.86 11.86 0 0 0 12.02 0C5.4 0 .06 5.34.06 11.93c0 2.1.55 4.16 1.6 5.98L0 24l6.24-1.63a11.9 11.9 0 0 0 5.78 1.49h.01c6.62 0 12-5.34 12-11.93 0-3.19-1.27-6.18-3.51-8.45ZM12.03 21.3h-.01a9.9 9.9 0 0 1-5.03-1.38l-.36-.21-3.7.96.99-3.6-.24-.37A9.9 9.9 0 0 1 2.1 11.9C2.1 6.5 6.58 2.1 12 2.1c2.64 0 5.12 1.02 6.99 2.87a9.7 9.7 0 0 1 2.9 6.94c0 5.4-4.48 9.9-9.86 9.9Zm5.45-7.42c-.3-.15-1.78-.88-2.06-.98-.28-.1-.49-.15-.71.15-.21.3-.82.97-1 1.17-.18.2-.36.22-.66.07-.3-.15-1.24-.45-2.36-1.45a8.79 8.79 0 0 1-1.63-2.02c-.17-.3-.02-.46.13-.61.13-.13.3-.33.45-.5.15-.17.2-.3.3-.5.1-.2.05-.37-.02-.52-.07-.15-.71-1.7-.98-2.32-.26-.62-.52-.52-.71-.52l-.6-.01c-.2 0-.52.07-.79.37-.27.3-1.04 1.02-1.04 2.5 0 1.47 1.07 2.9 1.22 3.1.15.21 2.1 3.21 5.08 4.5.71.31 1.27.49 1.7.63.71.22 1.36.19 1.87.11.57-.09 1.78-.73 2.03-1.43.25-.7.25-1.31.17-1.43-.07-.12-.27-.2-.57-.35Z"/></svg>
      </a>{% endif %}
    </div>

    <div class="smt__timer">
      <span class="smt__label">{{ block.settings.timer_label }}</span>
      <span class="smt__digits" id="smt-digits-{{ block.id }}">24:00:00</span>
    </div>
  </div>
</section>

<style>
.smt{ background:var(--smt-bg); color:var(--smt-fg); padding:clamp(20px,4vw,40px) 0; }
.smt__wrap{ text-align:center; }
.smt__title{ font-weight:900; font-size:clamp(1.4rem,3.5vw,2rem); margin:0 0 .4rem;
  background:linear-gradient(90deg,var(--smt-accent),#ff9ecf 70%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
.smt__desc{ margin:0 auto 1.2rem; max-width:680px; opacity:.9; }
.smt__icons{ display:inline-flex; gap:clamp(14px,2.2vw,28px); align-items:center; justify-content:center; margin:10px 0 18px; }
.smt__btn{ width:var(--smt-icon); height:var(--smt-icon); color:var(--smt-fg); display:inline-grid; place-items:center; border-radius:50%;
  background:#fff; box-shadow:0 4px 20px rgba(0,0,0,.06); border:1px solid rgba(0,0,0,.06); text-decoration:none; transition:transform .15s ease, box-shadow .2s ease, color .2s ease, background .2s ease, border-color .2s ease; }
.smt__btn:hover{ transform:translateY(-2px); box-shadow:0 10px 26px rgba(0,0,0,.12); border-color:var(--smt-accent); color:#fff; background:var(--smt-accent); }
.smt__timer{ display:flex; gap:.6rem; align-items:baseline; justify-content:center; }
.smt__label{ font-weight:700; opacity:.8; }
.smt__digits{ font-weight:900; font-size:var(--smt-timer); line-height:1; color:var(--smt-accent); letter-spacing:.03em; }
</style>

<script>
(function(){
  var EL_ID = 'smt-digits-{{ block.id }}';
  var DAY_MS = 24 * 60 * 60 * 1000;
  function pad(n){ return n<10 ? '0'+n : ''+n; }
  function remaining(){ var now = Date.now(); return DAY_MS - (now % DAY_MS); }
  function render(){
    var s = Math.floor(remaining()/1000), h = Math.floor(s/3600); s -= h*3600;
    var m = Math.floor(s/60); s -= m*60;
    var el = document.getElementById(EL_ID); if(el){ el.textContent = pad(h)+':'+pad(m)+':'+pad(s); }
  }
  render(); setInterval(render,1000);
})();
</script>

{% schema %}
{
  "name": "TLS ‚Äî Social + Timer",
  "target": "section",
  "settings": [
    { "type": "text", "id": "title", "label": "Titre", "default": "Rejoignez notre communaut√© üíñ" },
    { "type": "textarea", "id": "desc", "label": "Description", "default": "Profitez de nos offres limit√©es et ne manquez aucune nouveaut√© !" },

    { "type": "color", "id": "bg", "label": "Fond", "default": "#fff5fb" },
    { "type": "color", "id": "fg", "label": "Texte", "default": "#111111" },
    { "type": "color", "id": "accent", "label": "Accent", "default": "#ff5fa2" },

    { "type": "range", "id": "icon_size", "label": "Taille ic√¥nes (px)", "min": 20, "max": 80, "step": 2, "default": 40 },
    { "type": "range", "id": "timer_size", "label": "Taille timer (px)", "min": 20, "max": 80, "step": 2, "default": 36 },
    { "type": "text", "id": "timer_label", "label": "Texte avant le timer", "default": "Offre se termine dans" },

    { "type": "text", "id": "instagram_url", "label": "Lien Instagram", "default": "https://example.com/instagram" },
    { "type": "text", "id": "facebook_url", "label": "Lien Facebook", "default": "https://example.com/facebook" },
    { "type": "text", "id": "tiktok_url", "label": "Lien TikTok", "default": "https://example.com/tiktok" },
    { "type": "text", "id": "whatsapp_phone", "label": "Num√©ro WhatsApp (ex: +213 797 88 29 49)", "default": "+213 797 88 29 49" }
  ]
}
{% endschema %}
